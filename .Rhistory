# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
#########
# TESTING EQUIVALENCE OF BGEV WITH DELTA = 0 AND GEV FROM ENVSTATS
##########
# new strategy based on the fact that when delta = 0, bgev equals gev with parametesr mu sigma and xi,
# plot both densities to see if this is really true
library(EnvStats)
x = seq(-5,5,0.01)
delta = 0.1
mu = 0
sigma = runif(1,0.5,2)
shape = runif(1,-2,2)
y_gev = dgevd(x, location = mu, scale = sigma, shape = -shape)
y_bgev = bgev::dbgev(x, mu = mu, sigma = sigma, xi = shape, delta = delta)
plot(x,y_gev, lwd = 10, lty = 2)
lines(x,y_bgev, lwd = 2, col = "blue")
y = dnorm(x,mean = pars_norm$estimate[1], sd = pars_norm$estimate[2])
########################
# TESTS
#######################
source("cran_versions/bgev_versions_0.2/bgev/R/bgev_functions.R")
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/arquivos/estudos/estatistica/github_bgev")
########################
# TESTS
#######################
source("cran_versions/bgev_versions_0.2/bgev/R/bgev_functions.R")
########################
# TESTS
#######################
source("cran_versions/bgev_versions_0.2/bgev/R/bgev_functions.R")
getwd()
cd()
ls()
dir
dir("cran_versions/bgev_versions_0.2/bgev/R/bgev_functions.R")
########################
# TESTS
#######################
source("cran_versions/bgev_version_0.2/bgev/R/bgev_functions.R")
########################
# TESTS
#######################
source("cran_versions/bgev_version_0.2/bgev/R/bgev_functions.R")
source("cran_versions/bgev_version_0.2/bgev/R/distCheck.R")
########################
# TESTS
#######################
source("cran_versions/bgev_version_0.2/bgev/R/bgev_functions.R")
source("cran_versions/bgev_version_0.2/bgev/R/distCheck.R")
source("cran_versions/bgev_version_0.2/bgev/R/dist_check.R")
library(fBasics)
#-------------------------------------------
# dbgev
# mu in R; sigma > 0; xi in R ;  delta > -1;
for(i in 1:100){
mu = runif(1,-2,2)
sigma = runif(1,0.1,2)
#xi = 0.1
xi = runif(1,0.3,0.9) * sign(runif(1,-1,1))
delta = 1#runif(1,-0.6,2)
support = bgev.support(mu, sigma, xi, delta)
var.exists = ( xi != 0) & (xi < (delta + 1)/2)
#support = c(-50,50)
ret = distCheck(fun="bgev", n = 2000,
support.lower = support[1], support.upper = support[2], subdivisions = 5000,
mu = mu, sigma = sigma, xi = xi, delta = delta, var.exists = var.exists, print.result = TRUE)
if(ret$test1.density$error.check == FALSE)
break
print(rbind(unlist(ret$test3.mean.var$computed),c(ret$test3.mean.var$expected$mean$value,ret$test3.mean.var$expected$var,ret$test3.mean.var$expected$log)))
print(bgev.mean(mu = mu, sigma = sigma, xi = xi, delta = delta))
}
# qbgevd
# y in R; mu in R; sigma > 0; xi in R ;  delta > -1;
size = 1e5
limitvalues = matrix(c(1/size, 1-1/size,
-size, size,
size, size,
-size, size,
-1 + 1/size, size), 5, 2, byrow = TRUE)
rownames(limitvalues) = c("p","mu","sigma","xi","delta")
colnames(limitvalues) = c("liminf","limsup")
for(p in limitvalues[1,]){
for(mu in limitvalues[2,]){
for(sigma in limitvalues[3,]){
for(xi in limitvalues[4,]){
for(delta in limitvalues[5,]){
print(paste("(p,mu,sigma,xi,delta) = (",p,mu,sigma,xi,delta,") and qbgevd = ",try(qbgevd(p, mu, sigma, xi, delta)), sep = " " ))
}
}
}
}
}
mu = runif(1,-2,2)
sigma = runif(1,0.1,2)
xi = runif(1,0.1,2) * sign(runif(1,-1,1))
delta = runif(1,-0.9,2)
support = bgev.support(mu, sigma, xi, delta)
x = seq(-10,10,0.01)
var.exists = ( xi != 0) & (xi < (delta + 1)/2)
y = dbgev(x, mu = mu, sigma = sigma, xi = xi, delta = delta)
plot(x,y, main = round(support,2))
abline(v = support)
x = seq(-1.1,-1.08,0.0001)
var.exists = ( xi != 0) & (xi < (delta + 1)/2)
y = dbgev(x, mu = mu, sigma = sigma, xi = xi, delta = delta)
plot(x,y)
abline(v = support)
dbgev(support[2]-1e-10, mu = mu, sigma = sigma, xi = xi, delta = delta)
distCheck(fun="bgev", n = 2000,
support.lower = -Inf, support.upper = support[2], subdivisions = 5000,
mu = mu, sigma = sigma, xi = xi, delta = delta, var.exists = var.exists, robust = TRUE)
c(mu,sigma,xi,delta)
mu
distCheck(fun="bgev", n = 2000,
support.lower = -Inf, support.upper = support[2], subdivisions = 5000,
mu = mu, sigma = sigma, xi = xi, delta = delta, var.exists = var.exists, robust = TRUE)
distCheck(fun="bgev", n = 2000,
support.lower = -Inf, support.upper = support[2], subdivisions = 5000,
mu = mu, sigma = sigma, xi = xi, delta = delta, var.exists = var.exists, robust = TRUE)
source("cran_versions/bgev_version_0.2/bgev/R/bgev_functions.R")
source("cran_versions/bgev_version_0.2/bgev/R/dist_check.R")
library(fBasics)
####
# TESTE COM PARAMETROS FIGURA QUALIFICACAO DO MATHEUS. ESTUDO SIMULACAO.
mc = 100
n = 100
parsets = expand.grid(c(-1,0,1),c(1,2),c(-1,1),c(0,1))
colnames(parsets) = c("mu","sigma","xi","delta")
resmc = array(NA,dim = c(mc,4,nrow(parsets)))
for(i in 1:nrow(parsets)){
print(i)
par = parsets[i,]
for(j in 1:mc){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x), silent = TRUE)
# repeat if fail
while(inherits(res, "try-error")){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x), silent = TRUE)
}
resmc[j,,i] = res$par
}
}
bgev.mle
for(i in 1:nrow(parsets)){
print(i)
par = parsets[i,]
for(j in 1:mc){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x), silent = TRUE)
# repeat if fail
while(inherits(res, "try-error")){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x), silent = TRUE)
}
resmc[j,,i] = res$par
}
}
parsets = expand.grid(c(-1,0,1),c(1,2),c(-1,1),c(0,1))
colnames(parsets) = c("mu","sigma","xi","delta")
resmc = array(NA,dim = c(mc,4,nrow(parsets)))
for(i in 1:nrow(parsets)){
print(i)
par = parsets[i,]
for(j in 1:mc){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x), silent = TRUE)
# repeat if fail
while(inherits(res, "try-error")){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x), silent = TRUE)
}
resmc[j,,i] = res$par
}
}
for(i in 1:nrow(parsets)){
print(i)
par = parsets[i,]
for(j in 1:mc){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x, method_envstats = "pwme"), silent = TRUE)
# repeat if fail
while(inherits(res, "try-error")){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x, , method_envstats = "pwme"), silent = TRUE)
}
resmc[j,,i] = res$par
}
}
####
# TESTE COM PARAMETROS FIGURA QUALIFICACAO DO MATHEUS. ESTUDO SIMULACAO.
mc = 100
n = 100
parsets = expand.grid(c(-1,0,1),c(1,2),c(-1,1),c(0,1))
colnames(parsets) = c("mu","sigma","xi","delta")
resmc = array(NA,dim = c(mc,4,nrow(parsets)))
for(i in 1:nrow(parsets)){
print(i)
par = parsets[i,]
for(j in 1:mc){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x, method_envstats = "pwme"), silent = TRUE)
# repeat if fail
while(inherits(res, "try-error")){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x, , method_envstats = "pwme"), silent = TRUE)
}
resmc[j,,i] = res$par
}
}
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
x
bgev.mle(x, method_envstats = "pwme")
library(DEoptim)
bgev.mle(x, method_envstats = "pwme")
mc = 5
n = 100
parsets = expand.grid(c(-1,0,1),c(1,2),c(-1,1),c(0,1))
colnames(parsets) = c("mu","sigma","xi","delta")
resmc = array(NA,dim = c(mc,4,nrow(parsets)))
for(i in 1:nrow(parsets)){
print(i)
par = parsets[i,]
for(j in 1:mc){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x, method_envstats = "pwme"), silent = TRUE)
# repeat if fail
while(inherits(res, "try-error")){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x, method_envstats = "pwme"), silent = TRUE)
}
resmc[j,,i] = res$par
}
}
resmc
resmc[,,1:5]
resmc = resmc[,,1:5]
resmc.mean = t(apply(resmc, MARGIN=c(2,3), FUN=mean))
resmc.sd = t(apply(resmc, MARGIN=c(2,3), FUN=sd))
for(i in 1:nrow(parsets)){
mc.report = cbind(unlist(parsets[i,]),resmc.mean[i,],resmc.sd[i,])
colnames(mc.report) = c("True", "Mean", "Sd")
print(round(mc.report,3))
}
####
# TESTE COM PARAMETROS FIGURA QUALIFICACAO DO MATHEUS. ESTUDO SIMULACAO.
mc = 4
n = 100
parsets = expand.grid(c(-1,0,1),c(1,2),c(-1,1),c(0,1))
colnames(parsets) = c("mu","sigma","xi","delta")
resmc = array(NA,dim = c(mc,4,nrow(parsets)))
for(i in 1:nrow(parsets)){
print(i)
par = parsets[i,]
for(j in 1:mc){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x, method_envstats = "pwme"), silent = TRUE)
# repeat if fail
while(inherits(res, "try-error")){
x = rbgev(n, mu = par$mu,sigma = par$sigma,xi = par$xi,delta = par$delta)
res = try(bgev.mle(x, method_envstats = "pwme"), silent = TRUE)
}
resmc[j,,i] = res$par
}
}
resmc.mean = t(apply(resmc, MARGIN=c(2,3), FUN=mean))
resmc.sd = t(apply(resmc, MARGIN=c(2,3), FUN=sd))
for(i in 1:nrow(parsets)){
mc.report = cbind(unlist(parsets[i,]),resmc.mean[i,],resmc.sd[i,])
colnames(mc.report) = c("True", "Mean", "Sd")
print(round(mc.report,3))
}
# generate 100 values distributed according to a bimodal GEV
x = rbgev(50, mu = 0.2, sigma = 1, xi = 0.5, delta = 0.2)
# estimate the bimodal GEV parameters using the generated data
bgev.mle(x)
